<?xml version="1.0"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark"
    xmlns:mx="library://ns.adobe.com/flex/mx" viewActivate="onActivate()">
    <fx:Script><![CDATA[
        import com.easyinsight.analysis.AnalysisDefinition;
        import com.easyinsight.filtering.FilterDefinition;

        import mx.collections.ArrayCollection;
        import mx.events.ItemClickEvent;

        private var report:AnalysisDefinition;

        [Bindable]
        private var filterList:ArrayCollection;

        private function onActivate():void {
            trace("activating at all?");
            report = data as AnalysisDefinition;
            filterList = report.filterDefinitions;
            removeEventListener(ItemClickEvent.ITEM_CLICK, onItemClick);
            addEventListener(ItemClickEvent.ITEM_CLICK, onItemClick);
        }

        private function onItemClick(event:ItemClickEvent):void {
            var filterDefinition:FilterDefinition = filterList.getItemAt(event.index) as FilterDefinition;
            trace("type = " + filterDefinition.getType());
            var filterData:FilterInfo = new FilterInfo(filterDefinition, report.dataFeedID, report.analysisID, 0);
            if (filterDefinition.getType() == FilterDefinition.VALUE) {
                navigator.pushView(SingleValueFilterView, filterData);
            } else if (filterDefinition.getType() == FilterDefinition.ROLLING_DATE) {
                navigator.pushView(RollingFilterView, filterData);
            } else {
                navigator.pushView(GenericFilterView, filterData);
            }
        }

        ]]></fx:Script>
    <s:navigationContent>
        <s:Button label="Back" click="navigator.popView()"/>
    </s:navigationContent>
    <s:titleContent>
        <s:Label text="Report Filters" color="#FFFFFF"/>
    </s:titleContent>
    <s:actionContent>
    </s:actionContent>
    <s:List dataProvider="{filterList}" width="100%" height="100%"
            itemRenderer="com.easyinsight.reportviews.FilterListRenderer" labelField="label">

    </s:List>
</s:View>
