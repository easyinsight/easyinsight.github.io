<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%" implements="com.easyinsight.genredata.ICatalogPage"
	doubleClickEnabled="true">
	<mx:Metadata>
		[Event(name="returnToStore", type="com.easyinsight.listing.CatalogNavigationEvent")]
	</mx:Metadata> 	
	<mx:Script>
		<![CDATA[
            import com.easyinsight.framework.ModuleAnalyzeSource;
            import com.easyinsight.genredata.ModuleAnalyzeEvent;
            import com.easyinsight.solutions.InsightDescriptor;
            import mx.events.ListEvent;
			import mx.collections.ArrayCollection;

			[Bindable]
            public var insightDescriptors:ArrayCollection;            
			
			public function analyze():ModuleAnalyzeSource {
                var insightDescriptor:InsightDescriptor = null;
                if (insightDescriptorGrid.selectedItem != null) {
                    insightDescriptor = insightDescriptorGrid.selectedItem as InsightDescriptor;
                } else {
                    if (insightDescriptors.length == 0) {
                        // can't do anything...
                    } else {
                        insightDescriptor = insightDescriptors.getItemAt(0) as InsightDescriptor;
                    }
                }
                var analyzeSource:ModuleAnalyzeSource = null;
                if (insightDescriptor != null) {
                    analyzeSource = new AnalysisDefinitionAnalyzeSource(insightDescriptor);
                }
                return analyzeSource;
            }
			
			private function returnToStore():void {
				dispatchEvent(new CatalogNavigationEvent(CatalogNavigationEvent.RETURN_TO_STORE));
			}
			
			private function gridDoubleClick(event:ListEvent):void {
				var insightDescriptor:InsightDescriptor = event.currentTarget.selectedItem as InsightDescriptor;
				dispatchEvent(new ModuleAnalyzeEvent(new AnalysisDefinitionAnalyzeSource(insightDescriptor)));
			}
		]]>
	</mx:Script>
	<mx:VBox width="100%" height="100%">
		<mx:Button label="Return to Store" click="returnToStore()"/>	
		<mx:DataGrid dataProvider="{insightDescriptors}" width="100%" height="100%" id="insightDescriptorGrid" selectable="true" itemDoubleClick="gridDoubleClick(event)">
			<mx:columns>				
				<mx:DataGridColumn headerText="" width="20" dataField="title" itemRenderer="com.easyinsight.listing.AnalysisDefinitionIcon"/>
				<mx:DataGridColumn headerText="Name" dataField="name"/>
				<mx:DataGridColumn headerText="" width="100" dataField="name" itemRenderer="com.easyinsight.listing.AnalysisCatalogIconControls"/>
			</mx:columns>				
		</mx:DataGrid>
	</mx:VBox>
</mx:Canvas>
