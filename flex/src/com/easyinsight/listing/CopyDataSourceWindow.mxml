<?xml version="1.0" ?>
<util:EITitleWindow xmlns:util="com.easyinsight.util.*" xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Form>
        <mx:FormItem label="Data Source:">
            <mx:Label text="{dataSourceName}"/>
        </mx:FormItem>
        <mx:FormItem label="New Data Source Name:">
            <mx:TextInput text="{newDataSourceName}" id="newNameInput"/>
        </mx:FormItem>
        <mx:FormItem label="Include Data on Copy:">
            <mx:CheckBox id="includeData"/>
        </mx:FormItem>
        <mx:FormItem label="Include Reports:">
            <mx:CheckBox id="includeReports"/>
        </mx:FormItem>
        <mx:FormItem label="">
            <mx:Button label="Copy!" click="save()"/>
            <mx:Button label="Cancel" click="PopUpManager.removePopUp(this)"/>
        </mx:FormItem>
    </mx:Form>
    <mx:Script><![CDATA[
        import com.easyinsight.customupload.UploadConfigEvent;
        import com.easyinsight.util.ProgressAlert;

        import mx.managers.PopUpManager;

        [Bindable]
        private var dataSourceName:String;

        [Bindable]
        private var newDataSourceName:String;

        private var _descriptor:DataFeedDescriptor;

        override protected function commitProperties():void {
            super.commitProperties();
            dataSourceName = _descriptor.name;
            newDataSourceName = "Copy of " + dataSourceName;
        }

        private function save():void {
            ProgressAlert.alert(this, "Copying...", null, uploadService.copyDataSource);
            uploadService.copyDataSource.send(_descriptor.dataFeedID, newNameInput.text, includeData.selected, includeReports.selected);
        }

        private function copied():void {
            dispatchEvent(new UploadConfigEvent(UploadConfigEvent.UPLOAD_CONFIG_COMPLETE));
            PopUpManager.removePopUp(this);
        }

        public function set dataSourceDescriptor(value:DataFeedDescriptor):void {
            _descriptor = value;
            invalidateProperties();
        }]]></mx:Script>
    <mx:RemoteObject destination="userUpload" id="uploadService">
        <mx:method name="copyDataSource" result="copied()"/>
    </mx:RemoteObject>
</util:EITitleWindow>