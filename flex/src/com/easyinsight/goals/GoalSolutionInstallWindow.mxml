<?xml version="1.0" ?>
<util:EITitleWindow xmlns:util="com.easyinsight.util.*" xmlns:mx="http://www.adobe.com/2006/mxml" creationComplete="getSolutions()">
    <mx:Script><![CDATA[
import mx.managers.PopUpManager;
import com.easyinsight.solutions.SolutionEvent;
import mx.collections.ArrayCollection;

        public var goalTreeNode:GoalTreeNode;

        [Bindable]
        private var tagMatchedSolutions:ArrayCollection;
        [Bindable]
        private var allSolutions:ArrayCollection;

        private function getSolutions():void {
            tagSolutionsGrid.addEventListener(GoalSolutionInstallEvent.GOAL_SOLUTION_INSTALL, onSolutionInstall);
            allSolutionsGrid.addEventListener(GoalSolutionInstallEvent.GOAL_SOLUTION_INSTALL, onSolutionInstall);
            goalService.getSolutions.send(goalTreeNode.tags);
        }

        private function gotSolutions():void {
            var availableSolutionList:AvailableSolutionList = goalService.getSolutions.lastResult as AvailableSolutionList;
            tagMatchedSolutions = availableSolutionList.tagMatchedSolutions;
            allSolutions = availableSolutionList.allSolutions;
        }

        private function cancel():void {
            PopUpManager.removePopUp(this);
        }

        private function onSolutionInstall(event:GoalSolutionInstallEvent):void {
            //dispatchEvent(event);
            PopUpManager.removePopUp(this);
        }
]]></mx:Script>
    <mx:RemoteObject destination="goalService" id="goalService">
		<mx:method name="getSolutions" result="gotSolutions()"/>
	</mx:RemoteObject>
    <mx:VBox>
        <mx:ApplicationControlBar>
            <mx:Label text="Suggested Solutions"/>
        </mx:ApplicationControlBar>
        <mx:DataGrid dataProvider="{tagMatchedSolutions}" id="tagSolutionsGrid">
            <mx:columns>
                <mx:DataGridColumn headerText="Name" dataField="name"/>
                <mx:DataGridColumn headerText="Description" dataField="description"/>
                <mx:DataGridColumn headerText="" dataField="name" itemRenderer="com.easyinsight.goals.InstallSolutionToGoalControls"/>
            </mx:columns>
        </mx:DataGrid>
        <mx:ApplicationControlBar>
            <mx:Label text="All Available Solutions"/>
        </mx:ApplicationControlBar>
        <mx:DataGrid dataProvider="{allSolutions}" id="allSolutionsGrid">
            <mx:columns>
                <mx:DataGridColumn headerText="Name" dataField="name"/>
                <mx:DataGridColumn headerText="Description" dataField="description"/>
                <mx:DataGridColumn headerText="" dataField="name" itemRenderer="com.easyinsight.goals.InstallSolutionToGoalControls"/>
            </mx:columns>
        </mx:DataGrid>
        <mx:HBox width="100%" horizontalAlign="center">
            <mx:Button label="Cancel" click="cancel()"/>            
        </mx:HBox>
    </mx:VBox>
</util:EITitleWindow>