<?xml version="1.0" encoding="utf-8"?>
<mx:Box xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:util="com.easyinsight.util.*">
	<mx:Metadata>
		[Event(name="analysisStateChange", type="com.easyinsight.analysis.AnalysisStateChangeEvent")]
	</mx:Metadata>
	<mx:Script>
		<![CDATA[
			import com.easyinsight.analysis.charts.ChartTypes;
            import mx.events.MenuEvent;
            
            [Bindable]
            private var xmlList:XMLList;
            
            public function set mode(mode:String):void {
            	if (mode == "all") {
            		xmlList = all;
            	} else if (mode == "splitSource") {
            		xmlList = splitSource;
            	} else if (mode == "splitTarget") {
            		xmlList = splitTarget;
            	}
            }
			
			private function itemClickHandler(event:MenuEvent):void {
                if (event.item != null && event.item.@controller != null) {
                    event.currentTarget.label= event.label;
                    var controllerClass:Class = ControllerLookup.controllerForType(event.item.@type);
                    var controller:IReportController = new controllerClass();
                    dispatchEvent(new AnalysisStateChangeEvent(controller));
                }
            }
            
            public function set selectedLabel(type:int):void {
                setLabel(all, type);
            	//p2.label = selectedLabel;
            }

            private function setLabel(parent:XMLList, type:int):void {
                var nodes:XMLList = parent.children();
                for (var i:int = 0; i < nodes.length(); i++) {
                    var node:XMLList = XMLList(nodes[i]);
                    if (node.@type == type) {
                        p2.label = node.@label;     
                    }
                    setLabel(node, type);
                }
            }
		]]>
	</mx:Script>
	  <mx:XMLList id="all">
        <node label="Grid        ">
        	<node label="List" type="{AnalysisDefinition.LIST}"/>
        	<node label="Crosstab" type="{AnalysisDefinition.CROSSTAB}"/>
        	<node label="Tree" type="{AnalysisDefinition.TREE}"/>
        </node>
        <node label="Chart" icon="">
        	<node label="Column">
                <node label="2D Column" type="{AnalysisDefinition.COLUMN}"/>
                <node label="3D Column" type="{AnalysisDefinition.COLUMN3D}"/>
            </node>
        	<node label="Bar" icon="">
                <node label="2D Bar" type="{AnalysisDefinition.BAR}"/>
                <node label="3D Bar" type="{AnalysisDefinition.BAR3D}"/>
            </node>
            <node label="Line" icon="">
                <node label="2D Line" type="{AnalysisDefinition.LINE}"/>
                <node label="2D Line (Multiple Measures)" type="{AnalysisDefinition.MMLINE}"/>
                <node label="3D Line" type="{AnalysisDefinition.LINE3D}"/>
            </node>
            <node label="Pie" icon="">
                <node label="2D Pie" type="{AnalysisDefinition.PIE}"/>
                <node label="3D Pie" type="{AnalysisDefinition.PIE3D}"/>
            </node>
            <node label="Area" icon="">
                <node label="2D Area" type="{AnalysisDefinition.AREA}"/>
                <node label="3D Area" type="{AnalysisDefinition.AREA3D}"/>
            </node>
        	<node label="Plot" type="{AnalysisDefinition.PLOT}"/>
        	<node label="Bubble" type="{AnalysisDefinition.BUBBLE}"/>
        </node>
        <node label="Maps" icon="">
            <node label="World" type="{AnalysisDefinition.MAP_WORLD}"/>
            <node label="USA" type="{AnalysisDefinition.MAP_USA}"/>
            <node label="Americas" type="{AnalysisDefinition.MAP_AMERICAS}"/>
            <node label="Europe" type="{AnalysisDefinition.MAP_EUROPE}"/>
            <node label="Asia" type="{AnalysisDefinition.MAP_ASIA}"/>
            <node label="Middle East" type="{AnalysisDefinition.MAP_MIDDLE_EAST}"/>
        </node>        
        <node label="Tree Map" type="{AnalysisDefinition.TREEMAP}"/>
        <node label="Gauge" type="{AnalysisDefinition.GAUGE}"/>
        <!-- <node label="Split" state="Split"/>-->
    </mx:XMLList>
    <mx:XMLList id="splitSource">        
    	<node label="List" state=""/>
    </mx:XMLList>
    <mx:XMLList id="splitTarget">
        <node label="Grid" icon="">
        	<node label="Crosstab" state="Crosstab"/>
        </node>
        <node label="Chart" icon="">
        	<node label="Column" state="BasicChart" subState="{ChartTypes.COLUMN_FAMILY}"/>
        	<node label="Bar" state="BasicChart" subState="{ChartTypes.BAR_FAMILY}"/>
        	<node label="Line" state="BasicChart" subState="{ChartTypes.LINE_FAMILY}"/>
        	<node label="Pie" state="BasicChart" subState="{ChartTypes.PIE_FAMILY}"/>
        </node>
        <node label="Map" icon="">
        	<node label="Country and State" state="ILogMap"/>
        	<node label="Satellite and Street" state="YahooMap"/>
        </node>        
    </mx:XMLList>
    <mx:PopUpMenuButton id="p2" 
            dataProvider="{xmlList}"
            labelField="@label" width="100" popUpStyleName="CustomPopupMenu"
            showRoot="false" itemClick="itemClickHandler(event);"/>
</mx:Box>
