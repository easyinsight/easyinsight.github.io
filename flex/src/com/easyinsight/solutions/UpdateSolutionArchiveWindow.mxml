<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="400" height="300"
	creationComplete="doCreationComplete()">
	<mx:Script>
		<![CDATA[
			import mx.controls.Alert;
			import mx.managers.PopUpManager;
			import com.easyinsight.framework.User;
			import mx.collections.ArrayCollection;
			
			[Bindable]
			private var availableSolutions:ArrayCollection;
			
			[Bindable]
            private var file:FileReference = new FileReference();
            
            private function doBrowse(event:Event):void {
                file.browse();
            }	
            
            public function doCreationComplete():void {
                file.addEventListener(Event.SELECT, doSelect);
                file.addEventListener(DataEvent.UPLOAD_COMPLETE_DATA, doComplete);
                solutionService.getSolutions.send();
            }

            public function doSelect( event:Event ):void {
                fileName.text = file.name;                
            }          

            public function doSubmit():void {
                var request:URLRequest = new URLRequest("/app/SolutionUploadServlet");
                var vars:URLVariables = new URLVariables();
                
                vars.solutionID = solutionsBox.selectedItem.solutionID;

                request.data = vars;

                // Start the file upload process
                file.upload( request );
            }
            
            private function doComplete(event:Event):void {
            	Alert.show("Successful!");
            }

            private function cancel():void {
                PopUpManager.removePopUp(this);
            }
            
            private function gotSolutions():void {
            	this.availableSolutions = solutionService.getSolutions.lastResult as ArrayCollection;
            }
		]]>
	</mx:Script>
	<mx:RemoteObject destination="solutionService" id="solutionService">
		<mx:method name="getSolutions" result="gotSolutions()"/>
	</mx:RemoteObject>
	<mx:VBox>
		<mx:ComboBox id="solutionsBox" dataProvider="{availableSolutions}" labelField="name"/>
		<mx:TextInput id="fileName" editable="false" />
		<mx:Button label="Browse..." click="doBrowse( event )" />
		<mx:Button label="Submitx" click="doSubmit()"/>
		<mx:Button label="Close" click="cancel()"/>
	</mx:VBox>
</mx:TitleWindow>
