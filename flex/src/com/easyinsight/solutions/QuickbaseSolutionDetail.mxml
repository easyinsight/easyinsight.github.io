<?xml version="1.0" ?>
<solutions:SolutionDetailRenderer xmlns:mx="http://www.adobe.com/2006/mxml"
                                  xmlns:solutions="com.easyinsight.solutions.*">
    <mx:Script><![CDATA[
        import com.easyinsight.account.Account;
        import com.easyinsight.customupload.UploadConfigEvent;
        import com.easyinsight.framework.User;
        import com.easyinsight.genredata.AnalyzeEvent;
        import com.easyinsight.google.QuickbaseWindow;
        import com.easyinsight.listing.DescriptorAnalyzeSource;
        import com.easyinsight.util.PopUpUtil;

        import mx.controls.Alert;
        import mx.events.CloseEvent;
        import mx.managers.PopUpManager;


        private function created(event:UploadConfigEvent):void {
            dispatchEvent(new AnalyzeEvent(new DescriptorAnalyzeSource(event.feedID)));
        }

        private function initialSetup():void {
            if (User.getInstance().getAccountType() < Account.PRO) {
                Alert.show("If you want to use Easy Insight with Quickbase, you'll need to upgrade to the Professional or higher account tier.", "Upgrade Required",
                        Alert.OK | Alert.CANCEL, this, upgradeListener, null, Alert.CANCEL);
            } else {
                var window:QuickbaseWindow = new QuickbaseWindow();
                window.addEventListener(UploadConfigEvent.UPLOAD_CONFIG_COMPLETE, created);
                PopUpManager.addPopUp(window, this, true);
                PopUpUtil.centerPopUp(window);
            }
        }

        private function upgradeListener(event:CloseEvent):void {
            upgrade();
        }

        private function uploadConfigComplete(event:UploadConfigEvent):void {
            dispatchEvent(new AnalyzeEvent(new DescriptorAnalyzeSource(event.feedID)));
        }
]]></mx:Script>
    <mx:HBox width="100%" height="100%" horizontalGap="0">
        <solutions:HeaderShadeArea width="50" height="100%" leftColor="#000000" rightColor="#FFFFFF"/>
        <mx:VBox width="100%" height="100%" styleName="connectionDetailCanvas" horizontalAlign="center">
            <mx:HBox verticalAlign="middle" width="100%">
                <mx:Image source="{logo}" click="toVendorPage()"/>
                <mx:Spacer width="100%"/>
                <mx:TextArea backgroundAlpha="0" editable="false" selectable="false" borderStyle="none" width="620"
                             height="60"
                             text="Want the ability to perform custom Quickbase reporting? Whether it's simple visualizations or in depth business intelligence analysis, Easy Insight can get you that visibility in a couple of clicks!"
                             fontSize="14"/>
                <mx:Spacer width="100%"/>
            </mx:HBox>
            <mx:HRule width="100%" strokeColor="#333333"/>
            <mx:Box id="controlsBox" width="100%" horizontalAlign="center">
                <mx:Button label="Connect to Quickbase" fontSize="20" click="initialSetup()" styleName="grayButton"
                           id="installButton"/>
            </mx:Box>
            <mx:HRule width="100%" strokeColor="#333333"/>
            <mx:Image source="../assets/SimpleDashboard.jpg"/>
            <mx:TextArea backgroundAlpha="0" editable="false" selectable="false" borderStyle="none" width="820"
                         height="120"
                         text="Take advantage of Easy Insight to extend your Quickbase reporting capabilities to the next level of visibility and analysis. Easily apply custom filters to your Quickbase data. View data as lists, charte, trees, maps, or any of the other rich forms of visualization offered by Easy Insight. Share the reports with your coworkers or embed them into iGoogle or another dashboard."
                         fontSize="14"/>
        </mx:VBox>
        <solutions:HeaderShadeArea width="50" height="100%" leftColor="#FFFFFF" rightColor="#000000"/>
    </mx:HBox>
</solutions:SolutionDetailRenderer>