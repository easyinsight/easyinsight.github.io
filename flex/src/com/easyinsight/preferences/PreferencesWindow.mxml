<?xml version="1.0" ?>
<util:EITitleWindow xmlns:util="com.easyinsight.util.*" xmlns:mx="http://www.adobe.com/2006/mxml"
                    xmlns:tokens="com.easyinsight.tokens.*">
    <mx:Script><![CDATA[
        import com.easyinsight.framework.User;
        import com.easyinsight.listing.DataFeedDescriptor;

        import com.easyinsight.util.ProgressAlert;

        import mx.collections.ArrayCollection;
        import mx.managers.PopUpManager;

        private function gotDataSources():void {
            var dataSources:ArrayCollection = feedService.searchForSubscribedFeeds.lastResult as ArrayCollection;
            for each (var desc:DataFeedDescriptor in dataSources) {
                User.getSharedObject().data[desc.id.toString()] = null;
            }
            User.getSharedObject().flush();
        }

        private function clearCredentials():void {
            if (User.getSharedObject() != null) {
                ProgressAlert.alert(this, "Clearing saved credentials...", null, feedService.searchForSubscribedFeeds);
                feedService.searchForSubscribedFeeds.send();
            }
        }
        ]]></mx:Script>
    <mx:RemoteObject destination="feeds" id="feedService">
        <mx:method name="searchForSubscribedFeeds" result="gotDataSources()"/>
    </mx:RemoteObject>
    <mx:VBox paddingBottom="10" paddingLeft="10" paddingRight="10" paddingTop="10">
        <mx:Button label="Clear All Saved Credentials in the Browser" click="clearCredentials()"/>
        <mx:HRule width="100%"/>
        <tokens:TokenManagementWindow/>
        <mx:HRule width="100%"/>
        <mx:HBox width="100%" horizontalAlign="center">
            <mx:Button label="Close" click="PopUpManager.removePopUp(this)"/>
        </mx:HBox>
    </mx:VBox>
</util:EITitleWindow>