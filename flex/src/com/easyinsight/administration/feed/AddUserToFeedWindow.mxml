<?xml version="1.0" encoding="utf-8"?>
<util:EISlimWindow xmlns:util="com.easyinsight.util.*" xmlns:mx="http://www.adobe.com/2006/mxml" keyDown="submitted(event)" creationComplete="onCreationComplete()">
	<mx:Script>
		<![CDATA[
        import com.easyinsight.administration.sharing.UserStub;

        import mx.collections.ArrayCollection;
        import mx.managers.PopUpManager;

        [Bindable]
        private var userStubs:ArrayCollection;

        private function onCreationComplete():void {
            focusManager.setFocus(userIDInput);
            shareService.getUserStubs.send(_includeUser);
        }

        private function gotUserStubs():void {
            this.userStubs = shareService.getUserStubs.lastResult as ArrayCollection;
        }

        private function save():void {
            dispatchEvent(new UserLinkEvent(UserLinkEvent.ADD_USER_LINK, userIDInput.selectedItem as UserStub));
            PopUpManager.removePopUp(this);
        }

        private function submitted(event:KeyboardEvent):void {
            if (event.keyCode == Keyboard.ENTER) {
                save();
            }
        }

        private function cancel():void {
            PopUpManager.removePopUp(this);
        }

        private var _includeUser:Boolean = false;

        public function set includeUser(value:Boolean):void {
            _includeUser = value;
        }
		]]>
	</mx:Script>
	<mx:RemoteObject id="shareService" destination="share">
		<mx:method name="getUserStubs" result="gotUserStubs()"/>			
	</mx:RemoteObject>
	<mx:VBox styleName="TitleWindowContents">
		<mx:Label text="Enter the name of the user:"/>
		<mx:Form width="100%">
			<mx:FormItem label="User" direction="horizontal">
                <mx:ComboBox id="userIDInput" dataProvider="{userStubs}" labelField="displayName"/>				
			</mx:FormItem>		
			<mx:FormItem label="" direction="horizontal">
				<util:SaveButton label="Add" click="save()"/>
				<util:CancelButton label="Cancel" click="cancel()"/>
			</mx:FormItem>
		</mx:Form>
	</mx:VBox>	
	<mx:StringValidator source="{userIDInput}" property="text" minLength="0"/>
</util:EISlimWindow>
