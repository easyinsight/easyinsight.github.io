<?xml version="1.0" ?>
<util:EISlimWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:util="com.easyinsight.util.*">
    <mx:Script><![CDATA[
        import com.easyinsight.analysis.DashboardPDFCreator;
        import com.easyinsight.analysis.DashboardPDFWindow;
        import com.easyinsight.analysis.EmbedDashboardWindow;
        import com.easyinsight.report.DashboardURLWindow;
        import com.easyinsight.report.URLWindow;
        import com.easyinsight.util.PopUpUtil;

        import mx.core.UIComponent;

        import mx.core.UIComponent;

        import mx.managers.PopUpManager;

        private var _reportType:int;
        private var _dataSourceID:int;
        private var _dashboardName:String;
        private var _coreView:DisplayObject;
        private var _rootView:IDashboardViewComponent;

        private var _dashboardRenderer:DashboardRenderer;

        private var _dashboard:Dashboard;

        public function set dashboardRenderer(value:DashboardRenderer):void {
            _dashboardRenderer = value;
        }

        protected override function commitProperties():void {
            super.commitProperties();
            _dashboardName = _dashboard.name;
        }


        public function set rootView(value:IDashboardViewComponent):void {
            _rootView = value;
        }

        public function set coreView(value:DisplayObject):void {
            _coreView = value;
        }

        public function set dashboard(value:Dashboard):void {
            _dashboard = value;
        }

        private var _headerArea:UIComponent;

        public function set headerArea(value:UIComponent):void {
            _headerArea = value;
        }

        private function pdf():void {
            var window:DashboardPDFWindow = new DashboardPDFWindow();
            window.content = UIComponent(_coreView);
            window.headerArea = _headerArea;
            window.dashboard = _dashboard;
            PopUpManager.addPopUp(window, this, true);
            PopUpUtil.centerPopUp(window);
            PopUpManager.removePopUp(this);
        }

        private function url():void {
            var urlWindow:DashboardURLWindow = new DashboardURLWindow();
            urlWindow.dashboard = _dashboard;
            urlWindow.rootView = _rootView;
            urlWindow.dashboardRenderer = _dashboardRenderer;
            urlWindow.x = this.x;
            urlWindow.y = this.y;
            PopUpManager.addPopUp(urlWindow, this, true);
            PopUpManager.removePopUp(this);
        }

        private function embed():void {
            var embedReportWindow:EmbedDashboardWindow = new EmbedDashboardWindow();
            embedReportWindow.urlKey = _dashboard.urlKey;
            embedReportWindow.x = this.x;
            embedReportWindow.y = this.y;
            PopUpManager.addPopUp(embedReportWindow, this, true);
            PopUpManager.removePopUp(this);
        }

        private function printable():void {

        }
        ]]></mx:Script>
    <mx:VBox paddingTop="10" paddingLeft="10" paddingBottom="10" paddingRight="10" horizontalAlign="center">
        <mx:Label text="Click any of the options below to export the dashboard:" fontSize="14"/>
        <mx:Grid>
            <mx:GridRow>
                <mx:GridItem>
                    <util:SaveButton icon="@Embed(source='../../../../assets/document_x16.png')" label="Export to PDF" click="pdf()" labelPlacement="right" width="250"/>
                </mx:GridItem>
                <mx:GridItem>
                    <util:SaveButton icon="@Embed(source='../../../../assets/link.png')" label="Link by URL" click="url()" labelPlacement="right" width="250"/>
                </mx:GridItem>
                <mx:GridItem>
                    <util:SaveButton icon="@Embed(source='../../../../assets/plasma_tv.png')" label="Embed Dashboard into Website" click="embed()" labelPlacement="right" width="250"/>
                </mx:GridItem>
            </mx:GridRow>
        </mx:Grid>
        <mx:HBox width="100%" horizontalAlign="center">
            <util:CancelButton label="Close" click="PopUpManager.removePopUp(this)"/>
        </mx:HBox>
    </mx:VBox>
</util:EISlimWindow>