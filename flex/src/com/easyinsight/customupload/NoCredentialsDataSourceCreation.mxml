<?xml version="1.0" ?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Metadata>
		[Event(name="userConfigComplete", type="com.easyinsight.customupload.UploadConfigEvent")]
		[Event(name="userConfigCancel", type="com.easyinsight.customupload.UploadConfigEvent")]
	</mx:Metadata>
    <mx:Script><![CDATA[
        import com.easyinsight.genredata.ModuleAnalyzeEvent;
        import com.easyinsight.listing.DataFeedDescriptor;
        import com.easyinsight.listing.DescriptorAnalyzeSource;

        private var _dataSourceClass:Class;


        public function set dataSourceClass(val:Class):void {
            _dataSourceClass = val;
        }

        private function create():void {
            uploadService.newExternalDataSource.send(new _dataSourceClass(), null);
        }

        private function created():void {
            var id:int = uploadService.newExternalDataSource.lastResult as int;
            var descriptor:DataFeedDescriptor = new DataFeedDescriptor();
            descriptor.dataFeedID = id;
            descriptor.policy = new UploadPolicy();
            descriptor.policy.publiclyVisible = false;
            descriptor.name = "Admin Stats";
            dispatchEvent(new UploadConfigEvent(UploadConfigEvent.UPLOAD_CONFIG_COMPLETE, id));
            dispatchEvent(new ModuleAnalyzeEvent(new DescriptorAnalyzeSource(descriptor)));
        }
        ]]></mx:Script>
    <mx:RemoteObject destination="userUpload" id="uploadService">
        <mx:method name="newExternalDataSource" result="created()"/>
    </mx:RemoteObject>
    <mx:HBox width="100%" horizontalAlign="center">
        <mx:Button label="Create" click="create()"/>
        <mx:Button label="Cancel" click="dispatchEvent(new UploadConfigEvent(UploadConfigEvent.UPLOAD_CONFIG_CANCEL))"/>
    </mx:HBox>
</mx:VBox>